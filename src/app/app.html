<div *ngIf="!auth.isLoggedIn()" class="login-page">

  <mat-card class="login-card">
    <h3>–í—Ö–æ–¥ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h3>

    <form [formGroup]="loginForm" class="login-form">
      <input
        placeholder="–õ–æ–≥–∏–Ω"
        formControlName="login"
      />

      <input
        type="password"
        placeholder="–ü–∞—Ä–æ–ª—å"
        formControlName="password"
      />
    </form>

    <button
      mat-raised-button
      color="primary"
      (click)="login()"
    >
      –í–æ–π—Ç–∏
    </button>
  </mat-card>

</div>

<div *ngIf="auth.isLoggedIn()">

  <mat-toolbar color="primary" class="toolbar">

    <span class="app-title centered">
      –¢—Ä–µ–∫–µ—Ä –ø–æ–ª–µ–∑–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫
    </span>

    <div class="profile-box">
      <span class="profile-name">
        –ü—Ä–æ—Ñ–∏–ª—å: {{ auth.getUser()?.login }}
      </span>

      <button
        mat-button
        class="logout-btn"
        (click)="logout()"
      >
        –í—ã–π—Ç–∏
      </button>
    </div>

  </mat-toolbar>

  <div class="container">

    <mat-card class="streak-card">
      <b>–°–µ—Ä–∏—è 3/3 –æ—Å–Ω–æ–≤–Ω—ã—Ö:</b> {{ mainStreak }} / 7

      <div class="streak-message">
        {{ getStreakMessage() }}
      </div>
    </mat-card>

    <mat-card
      class="legend-card"
      *ngIf="mainStreak === 7"
    >
      <img
        src="assets/1.png"
        class="legend-image"
      />

      <div class="legend-title">–¢—ã –≤–∞—â–µ –ª–µ–≥–µ–Ω–¥–∞!!! üî•üî•üî•</div>
      <div class="legend-quote">
        –ü–æ–º–Ω–∏: ¬´–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ ‚Äî —ç—Ç–æ –º–æ—Å—Ç –º–µ–∂–¥—É —Ü–µ–ª—è–º–∏ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏¬ª
      </div>
    </mat-card>

    <mat-card
      class="habit-card"
      [class.main-habit]="habit.isMain"
      *ngFor="let habit of habits"
    >

      <div class="habit-header">

        <div class="title-wrapper">
          <input
            class="habit-title"
            [value]="habit.title"
            (change)="updateTitle(habit, $event)"
          />

          <span
            *ngIf="habit.isMain"
            class="main-badge"
          >
            –æ—Å–Ω–æ–≤–Ω–∞—è
          </span>
        </div>

        <button
          *ngIf="!habit.isMain"
          class="delete-btn"
          (click)="removeHabit(habit)"
        >
          ‚úï
        </button>

      </div>

      <div class="grid">
        <div
          class="day"
          *ngFor="let d of weekDays"
          [class.done]="isDone(habit, d)"
          (click)="toggle(habit.id, d)"
        >
          {{ d.slice(8,10) }}.{{ d.slice(5,7) }}
        </div>
      </div>

      <div class="progress">
        <div
          class="progress-bar"
          [style.width.%]="(getWeekDoneCount(habit) / 7) * 100"
        ></div>
      </div>

      <div class="progress-text">
        {{ getWeekDoneCount(habit) }} / 7
      </div>

    </mat-card>

    <mat-card class="add-card">
      <input
        placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–∏–≤—ã—á–∫–∞"
        [(ngModel)]="newHabitTitle"
      />

      <button
        mat-raised-button
        color="primary"
        (click)="addHabit()"
      >
        –î–æ–±–∞–≤–∏—Ç—å
      </button>
    </mat-card>

  </div>
</div>
